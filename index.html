<!DOCTYPE html>
   <head>
      <meta charset='utf-8'>
      <meta http-equiv="X-UA-Compatible" content="chrome=1">
      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
   <!--stylesheet--> 
      <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
      <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
      <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
      <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
   <!--Tab title-->
      <title>Smarter Parking</title>
    
      <!-- stylesheet
      <link rel="stylesheet" href="css/style.css">

      <!-- typekit font
      <script type="text/javascript" src="//use.typekit.net/nfj5apq.js"></script>
      <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

      <!-- modernizr
      <script type="text/javascript" src="js/vendor/modernizr-2.6.2.min.js"></script> -->
   </head>
   
   <body>
      <div class="inner">
      <header>
        <h1>Smarter Parking</h1>
        <h2> </h2>
      </div>
      </header>
    
   <div id="content-wrapper">
      <div class="inner clearfix">
      <section id="main-content">
         <h3><a name="LEVEL 1 PARKING" class="anchor" ><span class="octicon octicon-link"></span></a> LEVEL 1 PARKING</h3>
         <!--<h2><small>Live datastream value</small> <span id="myelement"></span></h2>-->
         <style>
            table,th,td {
              border:3px solid black;
            }
         </style>
          
         <table>
            <tr>
               <td style="text-align:center" style="width:300px" height="200">1     
               <button type="button" onclick="bookHandleAndCode()"> BOOK </button>
               <canvas id="space1" width="200" height="100"></canvas>
            
               <form id=bookCode1>
                  <p> Press Book to obtain your unique booking code</p>
               </form>
                
               <form>
                  Booking Code: <input type="text" id="codeEnter1" name="code1" size="10"><br> 
                  <button type="button" onclick="confirmBookCode1()"> CONFIRM </button>
               </form>
               </td>
            
            <td rowspan="3" style="width:200px"></td>
            
            <td style="text-align:center" style="width:300px" height="200">④     
               <label for="book1">Book!</label>
               <input id="book1" type="checkbox">
              <form>
                 Booking Code: <input type="text" name="code" size="10"><br>  
              </form>
            </td>	
          </tr>

          <tr>
          
            <td style="text-align:center" style="width:300px" height="200">②     
               <label for="book1">Book!</label>
               <input id="book1" type="checkbox">
              <form>
                Booking Code: <input type="text" name="code" size="10"><br>  
              </form>
            </td>
            
            <td style="text-align:center" style="width:300px" height="200">⑤
               <label for="book1">Book!</label>
               <input id="book1" type="checkbox">
              <form>
                Booking Code: <input type="text" name="code" size="10"><br>  
              </form>
            </td>		
          </tr>

          <tr>
            <td style="text-align:center" style="width:300px" height="200">③     
               <label for="book1">Book!</label>
               <input id="book1" type="checkbox">
              <form>
                Booking Code: <input type="text" name="code" size="10"><br>  
              </form>
            </td>
            
            <td style="text-align:center" style="width:300px" height="200">⑥    
               <label for="book1">Book!</label>
               <input id="book1" type="checkbox">
              <form>
                Booking Code: <input type="text" name="code" size="10"><br>  
              </form>
            </td>		
          </tr>

      </table>
          
      </div>
    </div>
    
    
   <script src="js/jquery.js"></script>
   <script src="http://d23cj0cdvyoxg0.cloudfront.net/xivelyjs-1.0.4.min.js"></script>
 
  <script>

    $(document).ready(function($) {

      xively.setKey( "ywafB6MNLUakqggSfAgfrSaQoyRhPsbYbRVfuqVILy5ctgQr" );

      var feedID        = 1868918819,  
          datastreamID  = "Sensor3";     
          selector      = "#myelement"; 

      xively.datastream.get (feedID, datastreamID, function ( datastream ) {

        $(selector).html( datastream["current_value"] );

        xively.datastream.subscribe( feedID, datastreamID, function ( event , datastream_updated ) {
          $(selector).html( datastream_updated["current_value"] );
        });
      });
    });   
    
    var c=document.getElementById("space1");
    var ctx=c.getContext("2d");
    ctx.font = "50px Arial";
    ctx.strokeStyle="rgb(154,205,50)";
    ctx.strokeText("FREE",30,50);
   
    
    
  
    handleBook1=function(){
      $.ajax({
         url: 'https://api.xively.com/v2/feeds/1868918819.csv',
         type: 'PUT',
         
         data: 'Sensor3,1',
         success: function() { alert('PUT completed'); },
         headers: {'X-ApiKey': 'ywafB6MNLUakqggSfAgfrSaQoyRhPsbYbRVfuqVILy5ctgQr'}
      });
    };
    
    bookToTaken1=function(){
        $.ajax({
         url: 'https://api.xively.com/v2/feeds/1868918819.csv',
         type: 'PUT',
         
         data: 'Sensor1,1',
         success: function() { alert('PUT completed'); },
         headers: {'X-ApiKey': 'ywafB6MNLUakqggSfAgfrSaQoyRhPsbYbRVfuqVILy5ctgQr'}
      });
    };
   
    var code1="";
    var possible = "abcdefghijklmnopqrstuvwxyz0123456789";
      
      for( var i=0; i < 5; i++ )
        code1 += possible.charAt(Math.floor(Math.random() * possible.length));
    
    bookCode1=function(){
     
      

    return code1;
    };
    
    confirmBookCode1=function(){
      var enteredC = document.getElementById('codeEnter1').value;

      if (enteredC == code1) {
         bookToTaken1();
         document.write('TY :)')
      }else{
         document.write('WRONG CODE, :(');
         }
    };
    
    showCode1=function(){
      document.getElementById("bookCode1").innerHTML=bookCode1();
    };
    
    bookHandleAndCode=function(){
       handleBook1();
       bookCode1();
       showCode1();
    };
   
  </script>
   
</body>
</html>
